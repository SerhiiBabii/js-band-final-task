(this["webpackJsonpjs-band-final-task"]=this["webpackJsonpjs-band-final-task"]||[]).push([[0],{28:function(e,t,a){e.exports=a(39)},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(15),o=a.n(c),l=a(11),u=a(9),s=a(2),i=Object(s.b)((function(e){return{user:e.books.user}}),(function(e){return{signOutUser:function(){return e({type:"SIGNUOT"})}}}))((function(e){var t=e.user,a=e.signOutUser,n=t.username,c=t.avatar;return r.a.createElement("div",null,r.a.createElement(l.b,{to:"/cart"},r.a.createElement("img",{height:"40",src:"./images/cart.svg",alt:"cart"})),r.a.createElement("button",{onClick:a,type:"button",className:"btn btn-primary m-2"},"Sing-Out"),r.a.createElement("img",{height:"40",className:"m-2 rounded-circle",src:c,alt:"avatar"}),r.a.createElement("span",null,n))})),m=Object(s.b)((function(e){return{user:e.books.user}}))((function(e){var t=e.user;return r.a.createElement("nav",{className:"navbar navbar-dark"},r.a.createElement("h3",null,"JS BAND STORE / Serhii Babii"),t.username?r.a.createElement(i,null):null)})),d=function(){return r.a.createElement("div",{className:"text-center"},r.a.createElement("img",{className:"text-center",height:"80",src:"./images/cart.svg",alt:"empty cart"}),r.a.createElement("p",null,"Cart empty."))},E=function(e){var t=e.currentCart,a=t.title,n=t.count,c=t.total;return r.a.createElement("tr",{className:"row"},r.a.createElement("td",{className:"col-7"},a),r.a.createElement("td",{className:"col-4"},n),r.a.createElement("td",{className:"col-1"},c))};E.defaultProps={currentCart:{},title:"",count:0,total:0};var b=E,p=function(e){var t=e.orderTotal;return r.a.createElement("div",null,r.a.createElement("b",null,"Total price, $",t))},f=Object(s.b)((function(e){return{cartItems:e.books.cart.cartItems,orderTotal:e.books.cart.orderTotal}}))((function(e){var t=e.cartItems,a=e.orderTotal;return r.a.createElement("div",null,r.a.createElement("table",{className:"table m-3"},r.a.createElement("tbody",null,t?t.map((function(e){return r.a.createElement(b,{key:e.id,currentCart:e})})):null)),r.a.createElement(p,{orderTotal:a}))})),v=Object(s.b)((function(e){return{cartItems:e.books.cart.cartItems}}),(function(e){return{purchase:function(){return e({type:"SEND_BOOKS"})}}}))((function(e){var t=e.cartItems,a=e.purchase;return r.a.createElement("div",null,r.a.createElement("div",{className:"text-right"},r.a.createElement("button",{onClick:a,disabled:!t.length,className:"btn btn-primary",type:"button"},"Purchase")),t.length?r.a.createElement(f,null):r.a.createElement(d,null))})),k=a(14),O=Object(s.b)(null,(function(e){return{addBookToCart:function(t,a){return e(function(e,t){return{type:"ADD_BOOK",bookId:e,quantity:t}}(t,a))}}}))((function(e){var t=e.id,a=e.price,c=e.maxBooks,o=e.addBookToCart,l=Object(n.useState)(1),u=Object(k.a)(l,2),s=u[0],i=u[1];return r.a.createElement("div",{className:"border p-2"},r.a.createElement("p",{className:"row"},r.a.createElement("span",{className:"col-8"},"Price, $"),r.a.createElement("span",{className:"col-2"},a)),r.a.createElement("div",{className:"row"},r.a.createElement("span",{className:"col-8"},"Count"),r.a.createElement("input",{className:"col-3 rounded pl-2 pr-0",value:s,type:"number",name:"countInput",onChange:function(e){return e.target.value<0?1:e.target.value>c?e.target.value:i(e.target.value)}})),r.a.createElement("p",{className:"row"},r.a.createElement("span",{className:"col-8"},"Total price "),r.a.createElement("span",{className:"col-2"},(a*s).toFixed(2))),r.a.createElement("div",{className:"text-right"},r.a.createElement("button",{onClick:function(){return o(t,s)},disabled:s<1,className:"btn btn-secondary",type:"button"},"Add to cart")))})),g=(a(38),function(){return r.a.createElement("div",{className:"lds-css ng-scope"},r.a.createElement("div",{className:"lds-wedges"},r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",null)),r.a.createElement("div",null,r.a.createElement("div",null)),r.a.createElement("div",null,r.a.createElement("div",null)),r.a.createElement("div",null,r.a.createElement("div",null)))))}),h=a(26),N=a(27),y="https://js-band-api.glitch.me",S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(a,n){fetch(e,t).then((function(e){if(e.status<400)return e.json();throw e})).then((function(e){a(e)})).catch((function(e){e.json().then((function(e){n(e)}))}))}))},j=function(){function e(){Object(h.a)(this,e)}return Object(N.a)(e,null,[{key:"get",value:function(e,t){return S("".concat(y).concat(e),{mode:"cors",headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t)}})}},{key:"post",value:function(e,t){return S("".concat(y).concat(e),{method:"POST",mode:"cors",headers:{"Content-type":"application/json",Accept:"application/json"},body:JSON.stringify(t)})}}]),e}(),B=Object(s.b)((function(e){return{book:e.books.book,loading:e.books.loading,token:e.books.user.token}}),(function(e){return{fetchBookRequest:function(){return e({type:"FETCH_BOOK_REQUEST"})},fetchBookSuccess:function(t){return e(function(e){return{type:"FETCH_BOOK_SUCCESS",book:e}}(t))},fetchBookFailure:function(t){return e(function(e){return{type:"FETCH_BOOK_FAILURE",error:e}}(t))}}}))((function(e){var t=e.match,a=e.token,c=e.loading,o=e.book,l=e.book,u=l.id,s=l.title,i=l.author,m=l.description,d=l.cover,E=l.tags,b=l.level,p=l.count,f=l.price,v=e.fetchBookSuccess,k=e.fetchBookRequest;e.fetchBookFailure;Object(n.useEffect)((function(){j.get("/books/".concat(t.params.id),a).then((function(e){k(),setTimeout((function(){return v(e)}),2e3)}))}),[k,v,t.params.id,a]);var h=d||"./images/imageNotFound.png";return o.title&&!c?r.a.createElement("div",{className:"m-3"},r.a.createElement("div",{className:"row"},r.a.createElement("img",{className:"col-4",src:h,alt:"poster"}),r.a.createElement("div",{className:"col-4"},r.a.createElement("p",null,"Book name:"," ",s),r.a.createElement("p",null,"Book author:"," ",i),r.a.createElement("p",null,"Book level:"," ",b),r.a.createElement("p",null,"Book tags:"," ",E)),r.a.createElement("div",{className:"col-4"},r.a.createElement(O,{id:u,price:f,maxBooks:p}))),r.a.createElement("p",null,"Description:",m)):r.a.createElement(g,null)})),_=Object(s.b)(null,(function(e){return{signInUser:function(t,a,n){return e(function(e,t,a){return{type:"SIGNIN",username:e,avatar:t,token:a}}(t,a,n))}}}))((function(e){var t=e.signInUser,a=Object(n.useState)(""),c=Object(k.a)(a,2),o=c[0],l=c[1],u=Object(n.useState)("error"),s=Object(k.a)(u,2),i=s[0],m=s[1];return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 text-center"},r.a.createElement("div",null,r.a.createElement("img",{className:"border",height:"250",src:"images/defaultAvatar.png",alt:"avatar"})),r.a.createElement("div",{className:"m-2"},r.a.createElement("label",{htmlFor:"username"},r.a.createElement("p",{className:"mb-0"},r.a.createElement("b",null,"Username")),r.a.createElement("input",{value:o,onChange:function(e){l(e.target.value),e.target.value.length<4||e.target.value.length>16?m("error"):m("")},className:"col-12",type:"text",name:"username",id:"username",placeholder:"type Username"})),i?r.a.createElement("p",{className:"text-danger"},"Field is not valid"):null),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e=o,a=t,void j.post("/signin",{username:e}).then((function(e){var t=e.username,n=e.avatar,r=e.token;a(t,n,r)}));var e,a},disabled:!!i,className:"col-2",type:"button"},"Sign-In"))))})),C=function(){return r.a.createElement("div",{className:"text-center"},r.a.createElement("img",{className:"col-8",src:"./images/error404.jpg",alt:"error404"}))},T=function(e){var t=e.book,a=t.id,n=t.cover,c=t.title,o=t.author,u=t.price,s=n||"images/imageNotFound.png";return r.a.createElement("div",{className:"cart row col-3 border m-4 p-3"},r.a.createElement("img",{className:"col-12",src:s,alt:"cover"}),r.a.createElement("p",{className:"col-12"},c),r.a.createElement("p",{className:"col-12"},o),r.a.createElement("p",{className:"row col-12"},r.a.createElement("span",{className:"col-8"},"Price:"," ",u),r.a.createElement(l.b,{to:"/books/".concat(a),className:"btn btn-secondary col-4"},"View")))},I=function(){return r.a.createElement("div",{className:"form-group row"},r.a.createElement("input",{className:"form-control col-6",type:"text",name:"search",placeholder:"Search by book name"}),r.a.createElement("select",{className:"form-control col-3",name:"price"},r.a.createElement("option",{value:"all"},"all"),r.a.createElement("option",{value:"from_0_to_15"},"0 < price > 15"),r.a.createElement("option",{value:"from_15_to_30"},"15 < price > 30"),r.a.createElement("option",{value:"more_than_30"},"price > 30")))},F=Object(s.b)((function(e){return{books:e.books.books,token:e.books.user.token,loading:e.books.loading}}),(function(e){return{fetchBooksRequest:function(){return e({type:"FETCHS_BOOK_REQUEST"})},fetchBooksSuccess:function(t){return e(function(e){return{type:"FETCH_BOOKS_SUCCESS",books:e}}(t))},fetchBooksFailure:function(t){return e(function(e){return{type:"FETCH_BOOKS_FAILURE",error:e}}(t))}}}))((function(e){var t=e.books,a=e.token,c=e.loading,o=e.fetchBooksRequest,l=e.fetchBooksSuccess;e.fetchBooksFailure;Object(n.useEffect)((function(){j.get("/books",a).then((function(e){o(),setTimeout((function(){return l(e)}),2e3)}))}),[o,l,a]);var u=c?r.a.createElement(g,null):null,s=t&&!c?t.map((function(e){return r.a.createElement(T,{key:e.id,book:e})})):null;return r.a.createElement("div",{className:"row p-3"},r.a.createElement("div",{className:"col-10"},r.a.createElement(I,null)),r.a.createElement("div",{className:"row"},u,s))})),w=a(10),U=a(21),x=a(12),K=function(e,t,a){return 0===t.count?[].concat(Object(x.a)(e.slice(0,a)),Object(x.a)(e.slice(a+1))):-1===a?[].concat(Object(x.a)(e),[t]):[].concat(Object(x.a)(e.slice(0,a)),[t],Object(x.a)(e.slice(a+1)))},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=t.id,r=void 0===n?e.id:n,c=t.count,o=void 0===c?0:c,l=t.title,u=void 0===l?e.title:l,s=t.total,i=void 0===s?0:s,m=i+a*e.price;return{id:r,count:+o+ +a,title:u,total:+m.toFixed(2)}},R=function(e,t,a){var n=0;return e.map((function(e){return n+=e.total})),n+t.price*a},D=function(e,t,a){var n=a.books,r=a.cart.cartItems,c=n.find((function(t){return t.id===e})),o=r.findIndex((function(t){return t.id===e})),l=r[o],u=P(c,l,t);return{cartItems:K(r,u,o),orderTotal:R(r,c,t).toFixed(2)}};function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){Object(U.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var q={user:{username:void 0,avatar:void 0,token:void 0},books:[],book:{},filters:{search:"",price:"all"},cart:{cartItems:[],orderTotal:void 0},loading:!1,error:null},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGNIN":return A({},e,{user:{username:t.username,avatar:t.avatar,token:t.token}});case"SIGNUOT":return A({},e,{user:{username:void 0,avatar:void 0,token:void 0}});case"SHOW_FILTERED_BOOKS":return A({},e,{filters:A({},e.filters,Object(U.a)({},t.name,t.value))});case"FETCHS_BOOK_REQUEST":return A({},e,{books:[],loading:!0,error:null});case"FETCH_BOOKS_SUCCESS":return A({},e,{books:t.books,loading:!1,error:null});case"FETCH_BOOKS_FAILURE":return A({},e,{books:[],loading:!1,error:t.error});case"FETCH_BOOK_REQUEST":return A({},e,{book:{},loading:!0,error:null});case"FETCH_BOOK_SUCCESS":return A({},e,{book:t.book,loading:!1,error:null});case"FETCH_BOOK_FAILURE":return A({},e,{book:{},loading:!1,error:t.error});case"ADD_BOOK":return A({},e,{cart:D(t.bookId,t.quantity,e)});case"SEND_BOOKS":return A({},e,{cart:{cartItems:[],orderTotal:void 0}});default:return e}},G=Object(w.b)({books:L}),J=Object(w.c)(G),Q=function(){return r.a.createElement(s.a,{store:J},r.a.createElement(l.a,null,r.a.createElement("div",{className:"container"},r.a.createElement("hr",null),r.a.createElement(m,null),r.a.createElement("hr",null),r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/"},r.a.createElement(u.a,{to:"/signin"})),r.a.createElement(u.b,{path:"/signin",component:_}),r.a.createElement(u.b,{exact:!0,path:"/books",component:F}),r.a.createElement(u.b,{path:"/books/:id",component:B}),r.a.createElement(u.b,{path:"/cart",component:v}),r.a.createElement(u.b,{exact:!0,path:"*",component:C})))))};o.a.render(r.a.createElement(Q,null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.c6e27e3b.chunk.js.map